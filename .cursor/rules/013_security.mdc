---
description: Security best practices and vulnerability prevention
globs: "*.ts,*.tsx,*.js,*.jsx,*.env*"
alwaysApply: false
---

# Security Configuration

**Security Best Practices:**
- Never commit secrets or API keys
- Validate all user inputs
- Use environment variables for sensitive data
- Scan for security vulnerabilities

**Next.js/Node Security:**
- Use environment variables via `process.env`
- Commit `.env.example`, never `.env` or `.env.local`
- Don't weaken auth / disable CSRF / reduce security headers "for convenience"
- If handling user input, validate and sanitize; never trust client data

**Security Checklist:**
- No secrets in code
- No unsafe defaults
- Input validation in place
- Error handling doesn't leak sensitive info
- Dependencies are up-to-date and secure

**Security Hooks:**
- Pre-commit secret scanning
- Dependency vulnerability checks
- Input validation enforcement
- Security audit logging

**Security Rules:**
- Never output real API keys, tokens, private keys, or credentials
- Use env vars and .env.example (never commit .env)
- Don't weaken auth checks "for convenience"
- Treat dependency/code execution cautiously; avoid untrusted install scripts

**Reference Documentation:**
- @rules/060_security-secrets.mdc - Secrets hygiene
- @rules/operational-rules.mdc - Core safety standards
