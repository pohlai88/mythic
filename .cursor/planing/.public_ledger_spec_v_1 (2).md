# Public Ledger Spec v1.0

**Status:** Ratified **Derived From:**

- Amendment **A-000** (Public Ledger, veto logging, hashing) — Ratified
- Amendment **A-001** (Courts by Office, interpretation notes attribution) —
  Ratified
- Titan Gate Registry v1.0 + CI Checklist Pack — Operational
- Titan Gate Policy v1.0 (JSON outputs, scope_declaration) — Ratified

**Purpose:** Define the **single authoritative audit trail** for:

- amendments and ratifications
- court verdicts and interpretation notes
- Titan gate runs (PASS/WARN/VETO), escalations, and audit sweeps
- derivation hashes (Origin + Constitution + Amendments) and integrity proofs

**Non-Doctrine Rule:** This spec defines recordkeeping mechanics only.

---

## 1. Ledger Principles (Non-Negotiable)

1. **Append-Only:** No deletion, no mutation, no overwrites.
2. **Immutability Proof:** Every entry is hash-chained.
3. **Public Accessibility:** Read access is granted to all stakeholders governed
   by the Constitution.
4. **Attribution:** Every entry is attributable to an Office + Team (or actor
   identity).
5. **Reproducibility:** Evidence references must be immutable artifacts.
6. **Deterministic Integrity:** Canonical serialization is required before
   hashing.

---

## 2. Ledger Data Model

### 2.1 Ledger Entry Envelope (Required)

Each entry SHALL follow this envelope:

- `ledger_version` (string) — `"1.0"`
- `entry_id` (string) — unique ID (ULID/UUID)
- `entry_type` (enum) — one of:
  - `AMENDMENT_PROPOSAL`
  - `AMENDMENT_VERDICT`
  - `AMENDMENT_RATIFICATION`
  - `COURT_INTERPRETATION_NOTE`
  - `TITAN_GATE_RUN`
  - `TITAN_AUDIT_RUN`
  - `TITAN_ESCALATION`
  - `DERIVATION_HASH`
- `timestamp` (ISO8601)
- `actor` (object)
  - `office` (string)
  - `team` (string)
  - `identity` (string) — immutable identity ref
- `artifact` (object)
  - `artifact_type` (enum) —
    `PR | COMMIT | BUILD | DEPLOY | RUNTIME_REQUEST | AUDIT_SCAN | DOC`
  - `artifact_ref` (string) — immutable reference (PR number, commit hash, build
    id, doc path+hash)
- `scope_declaration` (array of strings) — required where applicable (Titan)
- `payload` (object) — entry-type specific body
- `evidence_ref` (array of strings) — immutable refs only
- `prev_entry_hash` (string)
- `entry_hash` (string)

### 2.2 Entry Types (Payload Schemas)

#### A) `TITAN_GATE_RUN`

`payload` SHALL include:

- `result` — `PASS | VETO_HARD | VETO_SOFT | WARN`
- `gate_results[]` with:
  - `gate_id`, `clause_id`, `severity`, `verdict`, `summary`, `evidence_ref[]`
- `required_gates_by_scope[]`
- `policy_version`

#### B) `TITAN_AUDIT_RUN`

`payload` SHALL include:

- `audit_gates_executed[]`
- `result`
- `acs` (object) when applicable:
  - `baseline_used`, `score`, `allowed_range`
- `findings[]` with:
  - `finding_type`, `count`, `sample_refs[]`

#### C) `TITAN_ESCALATION`

`payload` SHALL include:

- `from` (`WARN`)
- `to` (`VETO_HARD`)
- `trigger` (`CONSECUTIVE | CUMULATIVE | REGRESSION`)
- `gate_id`
- `window`
- `evidence_ref[]`

#### D) `AMENDMENT_PROPOSAL`

`payload` SHALL include:

- `amendment_id`
- `target_clauses[]`
- `proposed_addition` (string or immutable doc ref)
- `traceability_check` (Origin doctrine/term)
- `impact_analysis` (Doctrine/AXIS/Titan)

#### E) `AMENDMENT_VERDICT`

`payload` SHALL include:

- `amendment_id`
- `court` (`DOCTRINE | INTEGRITY | EXECUTION`)
- `verdict` (`APPROVE | VETO | RECLASSIFY`)
- `reason`
- `notes_ref` (immutable doc ref)

#### F) `AMENDMENT_RATIFICATION`

`payload` SHALL include:

- `amendment_id`
- `signatories[]` with:
  - `office`, `identity_ref`, `timestamp`
- `effective_from`
- `derivation_hash_ref` (entry_id of a `DERIVATION_HASH` record)

#### G) `COURT_INTERPRETATION_NOTE`

`payload` SHALL include:

- `court`
- `clause_refs[]`
- `note` (string or immutable doc ref)
- `non_binding` — MUST be `true`

#### H) `DERIVATION_HASH`

`payload` SHALL include:

- `hash_type` — `"SHA-256"`
- `inputs[]` (immutable refs): Origin, Constitution, Amendment(s)
- `computed_hash`

---

## 3. Canonicalization and Hashing

### 3.1 Canonical Serialization (Required)

Before hashing, JSON MUST be serialized with:

- UTF-8
- sorted keys
- no insignificant whitespace
- normalized line endings (`\n`) for any embedded strings

Any entry that cannot be canonically serialized SHALL be rejected.

### 3.2 Hash Algorithm

- Hash type SHALL be **SHA-256** (or stronger with explicit versioning).
- `entry_hash = SHA256( canonical_json(entry_without_entry_hash) + prev_entry_hash )`

### 3.3 Derivation Hash Rule (A-000 Compliance)

After each ratified amendment:

- A `DERIVATION_HASH` entry SHALL be created.
- Inputs MUST include:
  - _LBOS Origin Paper (Sealed)_ (immutable hash ref)
  - _NexusCanon Constitution v1.0_ (immutable hash ref)
  - Newly ratified Amendment text (immutable hash ref)

---

## 4. Storage Rules

1. Ledger storage SHALL be **append-only**.
2. Entries SHALL be stored in:

- a **primary ordered ledger**
- **snapshot bundles** (periodic, immutable exports)

3. Storage MUST support:

- monotonic ordering
- tamper-evident hashing
- immutable backups

---

## 5. Access and Transparency

### 5.1 Read Access

- Read access SHALL be public to all stakeholders governed by the Constitution.

### 5.2 Append Access

Only the following may append:

- Titan Enforcement systems (service identity)
- Court Offices (Doctrine/Integrity/Execution)
- System Architect Office

All appenders MUST be attributable by `office + identity_ref`.

### 5.3 Redaction Policy

- Ledger SHALL NOT redact entries.
- Secrets MUST NOT be embedded; store elsewhere and reference immutable
  artifacts.

---

## 6. Retention and Archival

1. Minimum retention: **7 years** (default)
2. Annual archival bundles SHALL be produced.
3. Each snapshot bundle MUST include:

- range of `entry_id`s
- start/end hashes
- snapshot hash

---

## 7. Titan Contract Compliance

Titan outputs SHALL map 1:1 into:

- `TITAN_GATE_RUN`
- `TITAN_AUDIT_RUN`
- `TITAN_ESCALATION`

No translation loss is permitted.

---

## 8. Dispute Resolution Records

When a gate is disputed:

- record the original `TITAN_GATE_RUN`
- follow with `AMENDMENT_PROPOSAL` and/or Court `AMENDMENT_VERDICT`

Court decisions SHALL be immutable and attributed.

---

## 9. Ratification Notes

This spec is ratified. Operational parameters (identity scheme details, snapshot
cadence, size limits) are specified in **Annex A** and may evolve additively via
amendment.

---

**End of Public Ledger Spec v1.0 (Ratified)**
