# Public Ledger Spec v1.0 — Annex A (Example Entries + Test Vectors)

**Status:** Reference Annex (Non-Doctrinal) **Applies To:** Public Ledger Spec
v1.0 **Purpose:** Provide concrete example JSON entries and hash test vectors to
make the ledger spec executable.

---

## A1. Identity Reference Scheme (Recommended)

To satisfy immutability and attribution, `identity` / `identity_ref` SHOULD be
expressed as a public-key fingerprint:

- **Format:** `fp:sha256:<64-hex>`
- **Meaning:** SHA-256 fingerprint of the public key bytes for the actor/service
  identity.

This avoids mutable usernames/emails and supports cryptographic auditability.

---

## A2. Snapshot Cadence (Safe Baseline)

Unless superseded by a later additive policy, a safe operational baseline is:

- **Daily snapshots:** Titan gate runs + audit runs (high volume, operational)
- **Weekly snapshots:** Governance activity rollups (amendments / court
  verdicts)
- **Annual archival bundles:** Retention-grade immutable archives

Snapshot cadence changes SHOULD be ledger-recorded as governance events.

---

## A3. Ledger Entry Size Limits (Lean Ledger Rule)

To keep the ledger reproducible and auditable:

- Ledger payloads SHOULD NOT embed large blobs.
- Large content MUST be stored as immutable artifacts and referenced via
  `evidence_ref`.

**Recommended maximum JSON size:** 32 KB per ledger entry (excluding referenced
artifacts).

---

## A4. Canonicalization + Hash Computation (Test Vector Definition)

### A4.1 Canonical JSON

For hashing, the JSON is serialized with:

- UTF-8
- **sorted keys**
- no insignificant whitespace
- separators `,` and `:` (no spaces)

(Equivalent to the common “sorted keys + compact JSON” canonicalization
described in the spec.)

### A4.2 Entry Hash Formula (Example Implementation)

1. Construct `entry_without_entry_hash` (the full entry including
   `prev_entry_hash` but excluding `entry_hash`).
2. Compute:

> `entry_hash = SHA256( canonical_json(entry_without_entry_hash) + prev_entry_hash )`

Where `+` is string concatenation of UTF-8 text.

> Note: This Annex uses a **genesis** `prev_entry_hash = "000…000"` (64 zeros)
> for the first example entry.

---

## A5. Example Entry — TITAN_GATE_RUN (with computed hashes)

**Computed:**

- `prev_entry_hash`:
  `0000000000000000000000000000000000000000000000000000000000000000`
- `entry_hash`:
  `b6d33a342ec93885219fabc26f9d6a6fa14d62985a51fe91bed71de138443b65`

```json
{
  "ledger_version": "1.0",
  "entry_id": "01HZZZ00000000000000000000",
  "entry_type": "TITAN_GATE_RUN",
  "timestamp": "2026-01-10T12:00:00+07:00",
  "actor": {
    "office": "Integrity Court Chair",
    "team": "Titan Enforcement Team",
    "identity": "fp:sha256:7c2d4e0f9a2b8b6a9e7c0f1a3d5f7b9c1e2a4c6f8d0b1a2c3d4e5f6a7b8c9d0e"
  },
  "artifact": {
    "artifact_type": "PR",
    "artifact_ref": "PR-1842"
  },
  "scope_declaration": [
    "Workflow / Accounting logic changed",
    "Audit logging changed"
  ],
  "payload": {
    "result": "VETO_HARD",
    "policy_version": "Titan Gate Policy v1.0",
    "required_gates_by_scope": [
      "TITAN-CI-II01",
      "TITAN-LINT-II02",
      "TITAN-CI-III01",
      "TITAN-CI-V01",
      "TITAN-CI-V02",
      "TITAN-AUDIT-V02"
    ],
    "gate_results": [
      {
        "gate_id": "TITAN-CI-II01",
        "clause_id": "II.1",
        "severity": "VETO-HARD",
        "verdict": "PASS",
        "summary": "Accounting Truth Citation present in PRD.",
        "evidence_ref": ["repo:docs/prd/PO-Workflow.md@c9f1e2a"]
      },
      {
        "gate_id": "TITAN-CI-V02",
        "clause_id": "V.2",
        "severity": "VETO-HARD",
        "verdict": "VETO_HARD",
        "summary": "Audit event schema missing rationale/context fields.",
        "evidence_ref": [
          "repo:packages/audit/schema.json@4aa19bf",
          "ci:build/9812/artifacts/audit-schema-diff.txt@sha256:9f3d..."
        ]
      }
    ]
  },
  "evidence_ref": ["ci:build/9812/report.json@sha256:1b2c..."],
  "prev_entry_hash": "0000000000000000000000000000000000000000000000000000000000000000",
  "entry_hash": "b6d33a342ec93885219fabc26f9d6a6fa14d62985a51fe91bed71de138443b65"
}
```

---

## A6. Example Entry — TITAN_AUDIT_RUN (ACS baseline + regression evidence)

**Computed:**

- `prev_entry_hash`:
  `b6d33a342ec93885219fabc26f9d6a6fa14d62985a51fe91bed71de138443b65`
- `entry_hash`:
  `904f6b6d88651c08ab984a8a93c8bf040bc82dc71ba2f2723adc4af668861663`

```json
{
  "ledger_version": "1.0",
  "entry_id": "01HZZZ11111111111111111111",
  "entry_type": "TITAN_AUDIT_RUN",
  "timestamp": "2026-01-11T02:00:00+07:00",
  "actor": {
    "office": "Integrity Court Chair",
    "team": "Titan Enforcement Team",
    "identity": "fp:sha256:7c2d4e0f9a2b8b6a9e7c0f1a3d5f7b9c1e2a4c6f8d0b1a2c3d4e5f6a7b8c9d0e"
  },
  "artifact": {
    "artifact_type": "AUDIT_SCAN",
    "artifact_ref": "audit-run-2026-01-11T02:00:00+07:00"
  },
  "scope_declaration": ["Post-Deploy Daily Audit"],
  "payload": {
    "audit_gates_executed": ["TITAN-AUDIT-III01", "TITAN-AUDIT-V02"],
    "result": "WARN",
    "acs": {
      "baseline_used": 95,
      "score": 94.2,
      "allowed_range": "90–99"
    },
    "findings": [
      {
        "finding_type": "MISSING_PROVENANCE",
        "count": 3,
        "sample_refs": [
          "db:tx/98341@sha256:aa11...",
          "db:tx/98377@sha256:bb22..."
        ]
      }
    ]
  },
  "evidence_ref": ["audit:reports/2026-01-11/daily.json@sha256:55cc..."],
  "prev_entry_hash": "b6d33a342ec93885219fabc26f9d6a6fa14d62985a51fe91bed71de138443b65",
  "entry_hash": "904f6b6d88651c08ab984a8a93c8bf040bc82dc71ba2f2723adc4af668861663"
}
```

---

## A7. Example Entry — AMENDMENT_RATIFICATION (signatories + derivation hash ref)

**Computed:**

- `prev_entry_hash`:
  `904f6b6d88651c08ab984a8a93c8bf040bc82dc71ba2f2723adc4af668861663`
- `entry_hash`:
  `13a29ecb2bf50ec6368b60b512a7d9f2fa33fbe2e8e6e9adc7b10fb685bb66ef`

```json
{
  "ledger_version": "1.0",
  "entry_id": "01HZZZ22222222222222222222",
  "entry_type": "AMENDMENT_RATIFICATION",
  "timestamp": "2026-01-12T09:30:00+07:00",
  "actor": {
    "office": "System Architect",
    "team": "Governance Office",
    "identity": "fp:sha256:1a1b1c1d1e1f202122232425262728292a2b2c2d2e2f30313233343536373839"
  },
  "artifact": {
    "artifact_type": "DOC",
    "artifact_ref": "amendments/A-002.md@sha256:77dd..."
  },
  "scope_declaration": ["Governance / Amendments"],
  "payload": {
    "amendment_id": "A-002",
    "signatories": [
      {
        "office": "System Architect",
        "identity_ref": "fp:sha256:1a1b...3839",
        "timestamp": "2026-01-12T09:20:00+07:00"
      },
      {
        "office": "Doctrine Court Chair",
        "identity_ref": "fp:sha256:2b2c...c1c1",
        "timestamp": "2026-01-12T09:22:00+07:00"
      },
      {
        "office": "Integrity Court Chair",
        "identity_ref": "fp:sha256:7c2d...9d0e",
        "timestamp": "2026-01-12T09:25:00+07:00"
      },
      {
        "office": "Execution Court Chair",
        "identity_ref": "fp:sha256:3c3d...d2d2",
        "timestamp": "2026-01-12T09:28:00+07:00"
      }
    ],
    "effective_from": "2026-01-12T09:30:00+07:00",
    "derivation_hash_ref": "01HZZZ33333333333333333333"
  },
  "evidence_ref": ["repo:amendments/A-002.md@e1a5c9d"],
  "prev_entry_hash": "904f6b6d88651c08ab984a8a93c8bf040bc82dc71ba2f2723adc4af668861663",
  "entry_hash": "13a29ecb2bf50ec6368b60b512a7d9f2fa33fbe2e8e6e9adc7b10fb685bb66ef"
}
```

---

## A8. Example Entry — DERIVATION_HASH (Origin + Constitution + Amendment)

**Computed:**

- `prev_entry_hash`:
  `13a29ecb2bf50ec6368b60b512a7d9f2fa33fbe2e8e6e9adc7b10fb685bb66ef`
- `entry_hash`:
  `52cd1483f65b2d17b2ee00ecc92e2e9555b0baf46653b2982948d72e3bccd813`

```json
{
  "ledger_version": "1.0",
  "entry_id": "01HZZZ33333333333333333333",
  "entry_type": "DERIVATION_HASH",
  "timestamp": "2026-01-12T09:31:00+07:00",
  "actor": {
    "office": "System Architect",
    "team": "Governance Office",
    "identity": "fp:sha256:1a1b1c1d1e1f202122232425262728292a2b2c2d2e2f30313233343536373839"
  },
  "artifact": {
    "artifact_type": "DOC",
    "artifact_ref": "constitution/CONSTITUTION.md@sha256:aaee..."
  },
  "scope_declaration": ["Governance / Hashing"],
  "payload": {
    "hash_type": "SHA-256",
    "inputs": [
      "repo:origin/LBOS_Origin_Paper.md@sha256:0f0f...",
      "repo:constitution/CONSTITUTION.md@sha256:aaee...",
      "repo:amendments/A-002.md@sha256:77dd..."
    ],
    "computed_hash": "sha256:42bfcb5ccc0c45f353f0b78f9ad2eefbe6293ded7f609b8336756f0867f5fe0d"
  },
  "evidence_ref": [
    "ci:build/9901/artifacts/derivation-hash.txt@sha256:9911..."
  ],
  "prev_entry_hash": "13a29ecb2bf50ec6368b60b512a7d9f2fa33fbe2e8e6e9adc7b10fb685bb66ef",
  "entry_hash": "52cd1483f65b2d17b2ee00ecc92e2e9555b0baf46653b2982948d72e3bccd813"
}
```

---

## A9. Annex Notes (Implementation Discipline)

- Example hashes here are valid only if canonicalization is implemented exactly
  as A4 defines.
- In production, `artifact_ref` and `evidence_ref` SHOULD include immutable
  digests (commit hash, SHA-256, etc.).
- Any “…” placeholders in refs represent real digests/ids in an actual system.

---

**End of Annex A**
